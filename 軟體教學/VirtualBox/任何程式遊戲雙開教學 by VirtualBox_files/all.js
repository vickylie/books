var pix=pix||{p:{profile:{},friend:{},alb:{},blog:{},club:{},gb:{},acct:{}},f:{profile:{},friend:{},alb:{},blog:{},club:{},gb:{},acct:{}},v:{}};(function(c,b,a){pix.selectHover=function(){c(".list-table tr").hover(function(){c(this).toggleClass("hover")},function(){c(this).toggleClass("hover")})};pix.checkedHighlight=function(){};pix.loaded=function(){c("#overlay").toggle();c("#overlay").css("opacity","1");c("#loading").hide()};pix.loading=function(){c("#overlay").toggle().css({opacity:"0.5",left:(c(a).width()-c("#loading").width())/2,top:(c(a).height()-c("#loading").height())/2}).show()};pix.annelize=function(d,g,i){var h=c('<form class="oneTimeForm"></form>'),k=pix.rawdata(d),e,l,f,j=!!(typeof(i._ismobile)!="undefined"&&true===i._ismobile);if("text"==i._type){e=c('<input class="input-style input-text" name="content" type="text">')}else{if("textarea"==i._type){if(j){e=c('<textarea name="content"></textarea>')}else{e=c('<textarea class="input-style input-textarea" name="content" rows="5" style="font-size: small;width:98%"></textarea>')}}}e.val(k);h.append(e);for(l in i){if(i.hasOwnProperty(l)){if("_"==l.substr(0,1)){continue}e=c('<input type="hidden">').attr("name",l).val(i[l]);h.append(e)}}if(j){f=c('<div class="comment-functions"></div>').appendTo(h).append(c('<button type="submit">').text(pixlang.save));e=c('<button type="button">').text(pixlang.cancel).appendTo(f)}else{c('<input type="submit">').val(pixlang.save).appendTo(h);e=c('<input type="button">').val(pixlang.cancel).appendTo(h)}h.submit(function(){pix.loading();c.post(g,h.serializeArray(),function(m){if(i._success){i._success(m)}else{pix.refresh()}},"json");return false});e.click(function(){c(h).empty();c(d).show();if(i._cancel){i._cancel()}});c(d).hide().after(h)};pix.refresh=function(){a.location.reload()};pix.loadingwin=function(d){c("#overlaywin").remove();c("#loadingwin").remove();c(d).append('<div id="overlaywin"></div>');c(d).append('<div id="loadingwin"><img src="//s.pixfs.net/panel/images/common/loading.gif" alt=""></div>');if(c(d+" #overlaywin").css("opacity")=="0.5"){return}c(d+" #overlaywin").toggle().css("opacity","0.5");c(d+" #loadingwin").css("left",(c(d).width()-c("#loadingwin").width())/2).css("top",(c(d).height()-c("#loadingwin").height())/2).show()};pix.loadedwin=function(d){c(d+" #overlaywin").toggle().css("opacity","1");c(d+" #loadingwin").hide();c("#overlaywin").remove();c("#loadingwin").remove()};pix.blogcommentreply=function(f,e){var d="#post-reply-"+f+"-body";pix.annelize(d,e,{_type:"textarea",sToken:pix.sToken,_cancel:function(){c(".post-reply-"+f+"-button").css("display","")},_success:function(g){if(g.result){if(g.success){alert(g.result);pix.refresh()}else{alert("系統偵測您已被登出，請儲存你輸入的文字後，重新登入及回覆。")}}}});c(".post-reply-"+f+"-button").css("display","none")};pix.openAllCategory=function(d){var e=c("#category ul");e.each(function(f,h){var g=c(h);if(g.attr("id")){if("open"==d){g.css("display","block");c("#"+g.attr("id")+"-switch").attr("src","//s.pixfs.net/blog/images/choc/minus.gif")}else{g.css("display","none");c("#"+g.attr("id")+"-switch").attr("src","//s.pixfs.net/blog/images/choc/plus.gif")}}})};pix.commentSwitch=function(g,f){var e=c("#"+g),d=c("#"+f);if(!e||!d){return}if("none"==e.css("display")){e.css("display","block");d.attr("src","//s.pixfs.net/blog/images/choc/minus.gif").attr("alt","close trackbacks list")}else{e.css("display","none");d.attr("src","//s.pixfs.net/blog/images/choc/plus.gif").attr("alt","open trackbacks list")}};pix.gotoArchive=function(f){var e=f.selectedIndex,d=f.options[e].value;if(d!="-pixnet-"){a.location=d}};pix.jsonToObj=function(d){return JSON.parse(d)};pix.delArticle=function(e,d){var f,g;if(confirm(pixlang.delArticle_confirm)){if(d){f=function(h,i){g=h;alert(g.result);if(g.success){location.href="/blog"}}}else{f=function(h,i){alert(h.result);location.reload(true)}}c.post("/blog/manage?manageAction=delArticle&articleid="+e,{sToken:pix.sToken},f,"json")}};pix.delTrackback=function(e,d){if(confirm(pixlang.delTrackback_confirm)){c.post("/blog/manage?manageAction=delTrackback&tbid="+e+"&article_id="+d,{sToken:pix.sToken},function(f,g){alert(f.result);location.reload(true)},"json")}};pix.replyComment=function(d,e,f){c.post("/blog/manage?manageAction=addblogcommentreply&blogcomment_id="+d,{sToken:pix.sToken,content:e},function(g,h){alert(g.result);if(f){f()}},"json")};pix.delComment=function(d){if(confirm(pixlang.delComment_confirm)){c.post("/blog/manage?manageAction=delComment&commentid="+d,{sToken:pix.sToken},function(e,f){alert(e.result);location.reload(true)},"json")}};pix.delReComment=function(d){if(confirm(pixlang.delRecomment_confirm)){c.post("/blog/manage?manageAction=delReComment&commentid="+d,{sToken:pix.sToken},function(e,f){alert(e.result);location.reload(true)},"json")}};pix.hideComment=function(d,e){c.post("/blog/manage?manageAction=hideComment&commentid="+d+"&toStatus="+e,{sToken:pix.sToken},function(f){alert(f.result);location.reload(true)},"json")};pix.sendForwardTo=function(e,d){b.location="mailto:?subject="+e+"&body="+d};pix.autoImgResize=function(e,f){var d;if(e>0){c("#"+f).find("img").each(function(){d=c(this);if("blog468x60Banner"==d.parent().parent().attr("id")){return true}if(d.width()>e){var i=d.width(),g=d.height(),h=Math.round(g*e/i);d.width(e).height(h);d.mouseover(function(){c(this).width(i).height(g)}).mouseout(function(){c(this).width(e).height(h)})}})}};pix.fixPixnetPlayerID=function(){var h=a.getElementsByTagName("object"),g=[],d=h.length,f,e;for(f=0;f<d;f++){if(h[f].id.indexOf("PixnetPlayer")===0){e=h[f].id;if(g[e]===undefined){g[e]=1}else{g[e]++}}}for(f=0;f<d;f++){if(g[h[f].id]>1){h[f].id+="_"+(g[h[f].id]++);h[f].parentNode.innerHTML=h[f].parentNode.innerHTML}}};pix.insertToEditArea=function(e,d){if(!tinyMCE.getInstanceById(e)){pix.addTextToTextarea(d,a.getElementById(e))}else{if(true===pix.CheckMyStr("object",d)){tinyMCE.execCommand("mceInsertContent",false,d+"&nbsp;")}else{tinyMCE.execCommand("mceInsertContent",false,d)}if(c.browser.safari){tinyMCE.execCommand("mceSetContent",false,tinyMCE.getInstanceById(e).getContent())}}};pix.CheckMyStr=function(e,d){if(-1==d.indexOf(e)){return false}else{return true}};pix.caret=function(f){f.focus();if(f.selectionStart){return f.selectionStart}else{if(!a.selection){return 0}}var h="\u0001",g=a.selection.createRange(),e=g.duplicate(),d=0;e.moveToElementText(f);g.text=h;d=(e.text.indexOf(h));g.moveStart("character",-1);g.text="";return d};pix.setCaretPos=function(d,f){d.focus();if(d.selectionStart){d.selectionStart=f;d.selectionEnd=f;return}else{if(!a.selection){return}}var e=a.selection.createRange();e.moveStart("character",-d.value.length);e.moveEnd("character",-d.value.length);e.moveStart("character",f);e.moveEnd("character",0);e.select()};pix.addTextToTextarea=function(f,d){var e=pix.caret(d);if(e==-1){e=d.value.length}d.value=d.value.substr(0,e)+f+d.value.substr(e);pix.setCaretPos(d,e+f.length)};pix.mailForward=function(e,d){b.location="mailto:?subject="+e+"&body="+d;return false};pix.forwardToGB=function(e){var d="http://"+b.location.hostname+"/blog/importtoguestbook?aid="+e;b.open(d,"forwardToGuestBook","width=502, height=402")};c.fn.extend({getSafePageX:function(d){return c("body").width()-d>c(this).outerWidth()?d:c("body").width()-c(this).outerWidth()},setSafePageX:function(d,e){e=typeof e==="number"?e:0;return c(this).css("left",c.fn.getSafePageX.call(this,d)+e)},visible:function(){return c(this).css("visibility","visible")}});pix.albumPopInfo={init:function(d){pix.albumPopInfo.elems=d;c.each(d,function(){var h=c("#"+this[0]),f=h.attr("href"),e=c(f.substr(f.indexOf("#"))),g=this[1];this[2]=e;h.click(function(i){pix.albumPopInfo.preClick();pix.albumPopInfo.click(e,i,g);i.stopPropagation();i.cancelBubble=true;return false})})},preClick:function(){c.each(pix.albumPopInfo.elems,function(){if(this[2]&&this[2].hide){this[2].hide()}})},click:function(d,h,g){d.show().visible().setSafePageX(h.pageX).css("top",h.pageY);var f=(function(e){return function(){e.hide();c("body").unbind("click",f)}})(d);c("body").click(f);if(typeof g=="string"){d.load(g)}}};pix.iframePopup={init:function(h,e,f,d,g){c(f).live("click",function(i){c(h).find("h3").text(g);$div=c(h).show();$iframe_div=$div.find("#frame-content");$iframe_div.html('<iframe width="100%" height="100%" frameborder="0" src="'+e+'"></iframe>');$iframe=$iframe_div.find("iframe");$iframe.load(function(){$div.css("z-index",2147483647)});if(c.browser.msie&&c.browser.version<8){c(a.documentElement).css("overflow","hidden")}else{c("html").css("overflow","hidden")}return false});c(d).click(function(){if(c.browser.msie&&c.browser.version<8){c(a.documentElement).css("overflow","")}else{c("html").css("overflow","")}$div=c(h);$div.hide();return false})},preClick:function(){c.each(pix.albumPopInfo.elems,function(){if(this[2]&&this[2].hide){this[2].hide()}})},click:function(d,h,g){d.show().visible().setSafePageX(h.pageX).css("top",h.pageY);var f=(function(e){return function(){e.hide();c("body").unbind("click",f)}})(d);c("body").click(f);if(typeof g=="string"){d.load(g)}}};pix.hotkeyLocation=function(d){c.each(d,function(e,f){if(!!f){c(a).bind("keydown",{combi:e,disableInInput:true},function(){b.location.href=f})}})};c(function(){c(".drop").click(function(g){g.stopPropagation();g.cancelBubble=true;var h=c("+ .drop-menu",this),f=h.css("display");c(".drop + .drop-menu").hide();if("none"==f){h.show()}});c("body").click(function(){c(".drop + .drop-menu").hide()});pix.checkedHighlight();pix.selectHover()})})(jQuery,window,document);function CopyText(a){copy(document.getElementById(a).value)}function copy_to_clipboard(a){CopyText(a)}function copy(a){var c,d,b;if(window.clipboardData){window.clipboardData.setData("Text",a)}else{c="flashcopier";if(!document.getElementById(c)){d=document.createElement("div");d.id=c;document.body.appendChild(d)}document.getElementById(c).innerHTML="";b='<embed src="/static/js/copy/_clipboard.swf" FlashVars="clipboard='+escape(a)+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';document.getElementById(c).innerHTML=b}}function copyToClipboard(e){var c,b,f,a,g,d;if(window.clipboardData){window.clipboardData.setData("Text",e)}else{if(window.netscape){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");c=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!c){return}b=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!b){return}b.addDataFlavor("text/unicode");f={};a={};f=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);g=e;f.data=g;b.setTransferData("text/unicode",f,g.length*2);d=Components.interfaces.nsIClipboard;if(!c){return false}c.setData(b,null,d.kGlobalClipboard)}}alert(pixlang.copy_alert+e);return false};